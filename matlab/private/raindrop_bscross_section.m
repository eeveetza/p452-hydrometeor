function eta = raindrop_bscross_section(phi, f, R, T)
%raindrop_bscross_section Computes raindrop bi-static cross section
% as defined in Section 5.3.2
%
%     Input parameters:
%     phi        -   Scattering angle (rad)
%     f          -   Frequency (GHz)
%     T          -   Temperature (deg C)
%     R          -   Rainfall rate   
%
%     Output parameters:
%     eta        -   raindrop bi-static cross section
%
%
%     Example:
%      eta = raindrop_bscross_section(phi, f, R, T);

%     Rev   Date        Author                          Description
%     -------------------------------------------------------------------------------
%     v0    20JUL23     Ivica Stevanovic, OFCOM         Initial version

% issues, phi--> phi_s in (91), eta_1 --> eta?
% c(i,n,m,:)

c = zeros(4, 4, 8, 3);

% i = 0, n = 0,  Table 8 
c(1,1,:,:) = [-23.033	-0.019039	-1.3511e-07
    1.0988	0.0057909	-1.8732e-05
    -0.053826	-0.00051258	2.8893e-06
    0.0017167	2.0326e-05	-1.5242e-07
    -3.3231e-05	-4.2625e-07	3.8089e-09
    3.7396e-07	4.9297e-09	-4.969e-11
    -2.2438e-09	-2.9763e-11	3.2787e-13
    5.5409e-12	7.3317e-14	-8.6497e-16];

% i = 0, n = 1,  Table 9

c(1,2,:,:) = [1.758	0.0078061	-0.00019642
-0.034774	-0.0010409	4.8582e-05
0.0031934	1.2441e-05	-3.9051e-06
-0.00014758	1.6661e-06	1.5195e-07
3.3014e-06	-7.0142e-08	-3.2085e-09
-3.8772e-08	1.1439e-09	3.7652e-11
2.3188e-10	-8.5799e-12	-2.3101e-13
-5.5887e-13	2.4612e-14	5.779e-16
];

% i = 0, n = 2,  Table 10

c(1,3,:,:) = [-0.051224	0.00081531	1.1534e-05
0.0011587	-0.00031961	-2.3173e-06
-8.8754e-05	3.5484e-05	1.4933e-07
9.6328e-07	-1.6609e-06	-4.7112e-09
5.927e-08	3.9523e-08	8.0972e-11
-1.6618e-09	-5.0408e-10	-7.7464e-13
1.5626e-11	3.2862e-12	3.8749e-15
-5.0972e-14	-8.6057e-15	-7.8859e-18
];

% i = 1, n = 0,  Table 11

c(2,1,:,:) = [0.28927	0.037271	-0.00010078
-0.11742	-0.011059	6.6665e-05
0.010231	0.00093297	-8.6068e-06
-0.00041831	-3.5477e-05	4.2065e-07
8.8529e-06	7.2358e-07	-1.0192e-08
-1.0313e-07	-8.2014e-09	1.3111e-10
6.2591e-10	4.8736e-11	-8.5865e-13
-1.5469e-12	-1.1849e-13	2.2546e-15
];

% i = 1, n = 1,  Table 12

c(2,2,:,:) = [-0.2317	-0.005093	0.00045796
0.020016	-0.00076558	-0.00011298
0.00060157	0.00020785	9.1237e-06
-9.7303e-05	-1.2384e-05	-3.5392e-07
3.2711e-06	3.3064e-07	7.4324e-09
-5.0187e-08	-4.5084e-09	-8.6694e-11
3.6714e-10	3.0694e-11	5.2868e-13
-1.0386e-12	-8.2853e-14	-1.3148e-15
];

% i = 1, n = 2,  Table 13

c(2,3,:,:) = [-0.036841	-0.0025519	-2.6162e-05
0.012953	0.00084793	5.2688e-06
-0.001305	-8.5265e-05	-3.3134e-07
5.9518e-05	3.7912e-06	9.6604e-09
-1.454e-06	-8.7204e-08	-1.4711e-10
1.91e-08	1.085e-09	1.1752e-12
-1.2719e-10	-6.9419e-12	-4.3973e-15
3.3748e-13	1.7914e-14	5.0804e-18
];

% i = 2, n = 0,  Table 14

c(3,1,:,:) = [-0.0022144	-0.0014792	0.00030493
-0.008123	-0.00055742	-8.8598e-05
0.0018507	0.00015755	8.3245e-06
-8.484e-05	-8.944e-06	-3.572e-07
1.9127e-06	2.323e-07	7.9876e-09
-2.2827e-08	-3.1221e-09	-9.6893e-11
1.4148e-10	2.1074e-11	6.0585e-13
-3.5797e-13	-5.6545e-14	-1.5317e-15
];

% i = 2, n = 1,  Table 15

c(3,2,:,:) = [-0.048207	-0.019603	3.8001e-06
-0.00041118	0.0045669	-1.0444e-05
0.0016887	-0.00031651	1.7242e-06
-0.00011195	1.0267e-05	-1.0534e-07
3.0478e-06	-1.776e-07	2.9975e-09
-4.1397e-08	1.6755e-09	-4.3294e-11
2.8014e-10	-8.0718e-12	3.0902e-13
-7.5246e-13	1.5353e-14	-8.6683e-16
];

% i = 2, n = 2, Table 16

c(3,3,:,:) = [-0.1208	-0.0018073	-7.7431e-05
0.039712	0.00099445	2.2037e-05
-0.0039312	-0.00012817	-2.1388e-06
0.00017579	6.5734e-06	9.7426e-08
-4.0495e-06	-1.669e-07	-2.3253e-09
5.0716e-08	2.2341e-09	3.0006e-11
-3.2704e-10	-1.512e-11	-1.9832e-13
8.496e-13	4.0796e-14	5.2636e-16
];

% i = 2, n = 3,  Table 17

c(3,4,:,:) = [0.02176	0.0005804	9.4104e-06
-0.0067089	-0.00020457	-2.5829e-06
0.0006556	2.156e-05	2.4395e-07
-2.966e-05	-9.9711e-07	-1.0876e-08
6.9633e-07	2.3723e-08	2.5604e-10
-8.7919e-09	-3.0371e-10	-3.2742e-12
5.6633e-11	1.9905e-12	2.15e-14
-1.462e-13	-5.2428e-15	-5.6776e-17
];

% i = 3, n = 0,  Table 18

c(4,1,:,:) = [-0.046298	-0.0057663	-0.00018642
0.01272	0.0017156	4.8813e-05
-0.0010278	-0.0001572	-4.0434e-06
3.4667e-05	6.2343e-06	1.5655e-07
-6.1228e-07	-1.3209e-07	-3.2237e-09
5.8573e-09	1.5529e-09	3.65e-11
-2.9595e-11	-9.5349e-12	-2.1505e-13
6.2019e-14	2.3843e-14	5.1597e-16
];

% i = 3, n = 1,  Table 19

c(4,2,:,:) = [-0.15558	-0.0042536	-9.7633e-05
0.047606	0.0017754	3.2832e-05
-0.0046542	-0.00020881	-3.4242e-06
0.00020312	1.0088e-05	1.6314e-07
-4.6089e-06	-2.4592e-07	-4.0092e-09
5.6717e-08	3.2014e-09	5.2747e-11
-3.5983e-10	-2.1241e-11	-3.5329e-13
9.2209e-13	5.6467e-14	9.4664e-16
];

% i = 3, n = 2,  Table 20

c(4,3,:,:) = [0.11087	0.0061252	5.7319e-05
-0.029622	-0.0017355	-1.5993e-05
0.0025942	0.00016036	1.5228e-06
-0.00010795	-6.8539e-06	-6.7714e-08
2.3816e-06	1.5498e-07	1.5828e-09
-2.8856e-08	-1.9149e-09	-2.0088e-11
1.8081e-10	1.2223e-11	1.3102e-13
-4.5761e-13	-3.1539e-14	-3.4402e-16
];

% i = 3,  n = 3, Table 21

c(4,4,:,:) = [-0.015838	-0.00071563	-6.1847e-06
0.0042926	0.00019142	1.6456e-06
-0.00039171	-1.6809e-05	-1.5321e-07
1.6946e-05	6.9046e-07	6.7237e-09
-3.8371e-07	-1.5112e-08	-1.5611e-10
4.6824e-09	1.8183e-10	1.9738e-12
-2.9185e-11	-1.1361e-12	-1.2841e-14
7.3004e-14	2.8813e-15	3.3644e-17
];


b_inm = c(:,:,:,1) +  T * (c(:,:,:,2) + T * c(:,:,:,3)); % (94);

a = zeros(4,4);

for i = 1 : 4
    for n = 1 : 4
        a(i, n) = b_inm(i,n,1) + f * (b_inm(i,n,2) + f * (b_inm(i,n,3) + f * (b_inm(i,n,4) + f * (b_inm(i,n,5) + f * (b_inm(i, n, 6) + f * (b_inm(i,n,7) + f* b_inm(i,n,8)))))));
    end
end



u = zeros(4,1);

lR = log(R);

for i = 1:2

   u(i) = a(i,1) + lR * (a(i,2) + lR * a(i,3) );
end

for i = 3:4

    u(i) = a(i,1) + lR * (a(i,2) + lR * (a(i,3) + lR * a(i,4)));

end

sph = (sin(0.5*phi)).^2;

arg = u(1) + sph * (u(2)  + sph * (u(3) + sph * u(4)));

eta = exp(arg);

return
end